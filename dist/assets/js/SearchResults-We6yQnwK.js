import{r as e,j as s}from"./vendor-frSDhvcu.js";import{u as t}from"./useProduct-DwD5ms5c.js";import{P as r}from"./ProductFilter-D1eJOwrX.js";import{P as a}from"./ProductCard-BLZfNBJE.js";import{e as l}from"./index-Vo_pZ44y.js";import{S as i}from"./seo-MhTlIJlM.js";import{E as n}from"./ErrorMessage-DHxw210G.js";import{E as o}from"./EmptyState-7luI3g9b.js";import{a as c,L as d}from"./vendor-router-CdLpK7Hz.js";import"./LoginWrapper-B4NtgB4h.js";import"./vendor-apollo-CIbFPnud.js";const m=e.memo((({currentPage:e,totalPages:t,onPageChange:r})=>{if(t<=1)return null;const a=(()=>{const s=[];s.push(1);let r=Math.max(2,e-1),a=Math.min(t-1,e+1);a-r<2&&(2===r?a=Math.min(t-1,r+2):a===t-1&&(r=Math.max(2,a-2))),r>2&&s.push("...");for(let e=r;e<=a;e++)s.push(e);return a<t-1&&s.push("..."),t>1&&s.push(t),s})();return s.jsx("nav",{className:"flex justify-center",children:s.jsxs("ul",{className:"flex items-center",children:[s.jsx("li",{children:s.jsx("button",{onClick:()=>{e>1&&r(e-1)},disabled:1===e,className:"relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md "+(1===e?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-white text-gray-700 hover:bg-gray-50"),children:"Previous"})}),a.map(((t,a)=>s.jsx("li",{children:"..."===t?s.jsx("span",{className:"relative inline-flex items-center px-4 py-2 border border-gray-300 bg-white text-sm font-medium text-gray-700",children:"..."}):s.jsx("button",{onClick:()=>(s=>{s!==e&&"..."!==s&&r(s)})(t),className:"relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium "+(t===e?"z-10 bg-indigo-50 border-indigo-500 text-indigo-600":"bg-white text-gray-700 hover:bg-gray-50"),children:t})},a))),s.jsx("li",{children:s.jsx("button",{onClick:()=>{e<t&&r(e+1)},disabled:e===t,className:"relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md "+(e===t?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-white text-gray-700 hover:bg-gray-50"),children:"Next"})})]})})}));function x(){const x=c(),[u,h]=e.useState(""),{searchProducts:g,globalProductAggregations:f,fetchGlobalProductAggregations:j,contextLoading:p,contextError:y}=t(),[v,N]=e.useState([]),[b,S]=e.useState([]),[w,P]=e.useState({}),[C,E]=e.useState("relevance"),[$,_]=e.useState("DESC"),[A,D]=e.useState(1),[F]=e.useState(12),[L,R]=e.useState(0),[M,k]=e.useState(!1);e.useEffect((()=>{const e=new URLSearchParams(x.search).get("q")||"";h(e),N([]),D(1),P({});(async()=>{e&&await j()})()}),[x.search,j]),e.useEffect((()=>{S(u&&f||[])}),[f,u]),e.useEffect((()=>{N([]),N([]),D(1)}),[w,C,$]);const H=e.useCallback((async()=>{if(!u)return N([]),void R(0);k(!0);const e=Object.entries(w).filter((([,e])=>e.length>0)).map((([e,s])=>{})).filter((e=>null!==e)),s={searchQuery:u,currentPage:A,pageSize:F,sortField:C,sortDirection:$,filterGroups:e};try{const e=await g(s);N((null==e?void 0:e.items)||[]),R((null==e?void 0:e.total_count)||0)}catch(t){}finally{k(!1)}}),[u,A,F,C,$,w,g]);e.useEffect((()=>{H()}),[H]);const T=p||M,U=Math.ceil(L/F);return T&&0===v.length?s.jsx("div",{className:"container mx-auto px-4 py-8",children:s.jsx("div",{className:"flex justify-center items-center h-64",children:s.jsx(l,{})})}):y?s.jsxs("div",{className:"container mx-auto px-4 py-8",children:[s.jsx(n,{message:y.message||"An error occurred while searching."}),s.jsx("p",{className:"mt-4 text-center",children:s.jsx(d,{to:"/",className:"text-indigo-600 hover:underline",children:"Return to homepage"})})]}):u||T?s.jsxs(s.Fragment,{children:[s.jsx(i,{title:`Search Results for "${u}"`,description:`Find products matching your search for "${u}".`,ogTitle:`Search Results for "${u}"`,ogUrl:`${window.location.origin}${x.pathname}${x.search}`}),s.jsxs("div",{className:"container mx-auto px-4 py-8",children:[s.jsx("nav",{className:"mb-6",children:s.jsxs("ol",{className:"flex flex-wrap text-sm",children:[s.jsxs("li",{className:"flex items-center",children:[s.jsx(d,{to:"/",className:"text-gray-600 hover:text-indigo-600",children:"Home"}),s.jsx("span",{className:"mx-2 text-gray-400",children:"/"})]}),s.jsx("li",{className:"flex items-center",children:s.jsxs("span",{className:"text-indigo-600",children:['Search Results for "',u,'"']})})]})}),s.jsx("div",{className:"mb-8",children:s.jsxs("h1",{className:"text-3xl font-bold mb-4",children:['Search Results for "',u,'"']})}),s.jsxs("div",{className:"flex flex-col md:flex-row gap-8",children:[b.length>0&&s.jsx("aside",{className:"w-full md:w-1/4",children:s.jsx(r,{filters:b,appliedFilters:w,onFilterChange:(e,s)=>{P((t=>{const r={...t};return 0===s.length?delete r[e]:r[e]=s,r})),D(1)}})}),s.jsxs("main",{className:"w-full "+(b.length>0?"md:w-3/4":"md:w-full"),children:[s.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6",children:[s.jsx("div",{className:"mb-4 sm:mb-0",children:s.jsx("p",{className:"text-gray-600",children:L>0?`Showing ${v.length} of ${L} products`:"No products found."})}),L>0&&s.jsxs("div",{className:"flex items-center",children:[s.jsx("label",{htmlFor:"sort",className:"mr-2 text-gray-600",children:"Sort by:"}),s.jsxs("select",{id:"sort",className:"border rounded p-2 focus:outline-none focus:ring-2 focus:ring-indigo-600",value:`${C}_${$}`,onChange:e=>{const s=e.target.value;if(s.includes("_")){const[e,t]=s.split("_");E(e),_(t.toUpperCase())}else E(s),_("DESC");D(1)},children:[s.jsx("option",{value:"relevance_DESC",children:"Relevance"}),s.jsx("option",{value:"name_ASC",children:"Name (A-Z)"}),s.jsx("option",{value:"name_DESC",children:"Name (Z-A)"}),s.jsx("option",{value:"price_ASC",children:"Price (Low to High)"}),s.jsx("option",{value:"price_DESC",children:"Price (High to Low)"}),s.jsx("option",{value:"created_at_DESC",children:"Newest"})]})]})]}),T&&0===v.length?s.jsx("div",{className:"flex justify-center items-center h-64",children:s.jsx(l,{})}):!T&&0===v.length&&u?s.jsx(o,{message:`No products found for "${u}". Try a different search term or adjust your filters.`}):v.length>0?s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:v.map(((e,t)=>s.jsx(a,{productsdata:[e],isLCPCandidate:0===t&&1===A},e.id||`product-${t}`)))}):null,T&&v.length>0&&s.jsx("div",{className:"flex justify-center my-8",children:s.jsx(l,{})}),U>1&&!T&&v.length>0&&s.jsx("div",{className:"mt-8 flex justify-center",children:s.jsx(m,{currentPage:A,totalPages:U,onPageChange:e=>{D(e),window.scrollTo(0,0)}})})]})]})]})]}):s.jsxs("div",{className:"container mx-auto px-4 py-8",children:[s.jsx(i,{title:"Search",description:"Search for products."}),s.jsx(o,{message:"Please enter a search term to find products."})]})}export{x as default};
//# sourceMappingURL=SearchResults-We6yQnwK.js.map

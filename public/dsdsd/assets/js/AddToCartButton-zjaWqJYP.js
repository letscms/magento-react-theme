import{R as t,r as e,j as o,y as n,z as r,p as i}from"./vendor-frSDhvcu.js";import{v as s,i as a}from"./index-CvpdAI6N.js";import{L as u}from"./LoginWrapper-BvE8Zoxs.js";import{u as l}from"./vendor-router-CdLpK7Hz.js";const c=t.memo((({product:t,quantity:c,className:d="bg-blue-700 text-white px-4 py-2 rounded hover:bg-blue-800 transition",showQuantity:p=!1,buttonText:m="Add to Cart",onSuccess:_=()=>{},onError:f=()=>{},selectedOptions:g,bundleSelections:b,groupedItemsQuantities:h})=>{const{addItemToCart:y,loading:v}=s(),x=c,[j,w]=e.useState(!1),C=a(),k=l(),N=v||j,q=`${d} ${N?"opacity-70 cursor-not-allowed":""}`;return o.jsx("div",{children:o.jsx("button",{type:"button",className:q,onClick:async()=>{if(t&&t.sku){if(!C){if(!(await(async()=>{const t=document.createElement("div"),e=r.createRoot(t);return e.render(o.jsx(u,{})),(await i.fire({html:t,showConfirmButton:!1,showCloseButton:!0,customClass:{container:"login-popup-container",popup:"login-popup"},width:"500px",didDestroy:()=>{e.unmount()}})).isConfirmed})()))return}if("IN_STOCK"!==t.stock_status)return n.error(`${t.name} is out of stock.`),k(`/product/${t.url_key}`);if(!(t=>{var e,o,n,r;if(!t)return;return!!{DownloadableProduct:!(null==(e=t.downloadable_product_links)?void 0:e.length),BundleProduct:!(null==(o=t.bundle_options)?void 0:o.length),GroupedProduct:!(null==(n=t.items)?void 0:n.length),ConfigurableProduct:!(null==(r=t.configurable_options)?void 0:r.length)}[t.__typename]&&(k(`/product/${t.url_key}`),!0)})(t))try{w(!0);const e=(()=>{var e,o;const{type_id:n,sku:r,name:i,price_range:s,small_image:a}=t,u={sku:r,qty:x,name:i||"Product",price:(null==(o=null==(e=null==s?void 0:s.minimum_price)?void 0:e.final_price)?void 0:o.value)||0,image:(null==a?void 0:a.url)||""};switch(n){case"configurable":return g?{...u,product_option:{extension_attributes:{configurable_item_options:Object.entries(g).map((([t,e])=>({option_id:String(t),option_value:Number(e)})))}}}:null;case"bundle":return b?{...u,product_option:{extension_attributes:{bundle_options:Object.values(b).map((t=>({option_id:t.option_id,option_qty:t.quantity,option_selections:[t.selection_id]})))}}}:null;case"grouped":return h?{...u,qty:1,extension_attributes:{grouped_items:Object.entries(h).filter((([,t])=>t>0)).map((([t,e])=>({sku:t,qty:e})))}}:null;default:return u}})();if(!e)return void n.error("Please select required options before adding to cart.");(await y(e)).success&&(n.success(`${t.name} added to cart!`,{position:"top-right",autoClose:3e3}),_(t,x))}catch(e){n.error(`Failed to add ${t.name} to cart. Please try again.`,{position:"top-right",autoClose:5e3}),f(e)}finally{w(!1)}}},disabled:N,children:N?o.jsxs("span",{className:"flex items-center justify-center",children:[o.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",viewBox:"0 0 24 24",children:[o.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),o.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Adding..."]}):m})})}));export{c as A};
//# sourceMappingURL=AddToCartButton-zjaWqJYP.js.map

import{r as e,z as a,j as l,p as o,y as i}from"./vendor-frSDhvcu.js";import{u as t}from"./seo-D9cx9PBx.js";import{v as n,a as r}from"./index-CvpdAI6N.js";import{L as s}from"./LoginWrapper-BvE8Zoxs.js";import{u as c,L as d}from"./vendor-router-CdLpK7Hz.js";const u={simple:"Simple Product",configurable:"Configurable",grouped:"Grouped Product",virtual:"Virtual Product",bundle:"Bundle Product",downloadable:"Downloadable",ConfigurableProduct:"Configurable"},m=({rating:e,reviewCount:a})=>{const o=Math.round(e/20);return l.jsxs("div",{className:"flex items-center mb-2",children:[l.jsx("div",{className:"flex text-yellow-400",children:Array.from({length:5},((e,a)=>l.jsx(p,{filled:a<o},a)))}),l.jsxs("span",{className:"text-gray-500 text-sm ml-2",children:["(",a||0,")"]})]})},p=({filled:e})=>l.jsx("svg",{className:"w-4 h-4 "+(e?"fill-current":"fill-gray-300"),viewBox:"0 0 20 20",children:l.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})}),g=({price:e,regularPrice:a,isOnSale:o,formatPrice:i})=>l.jsxs("div",{className:"flex flex-col",children:[l.jsx("span",{className:"text-indigo-600 font-bold",children:i(e)}),o&&l.jsx("span",{className:"text-gray-500 text-sm line-through",children:i(a)})]}),h=({isAdding:e,isOutOfStock:a,onClick:o})=>l.jsx("button",{className:"text-indigo-600 hover:bg-indigo-50 p-2 rounded-full "+(e||a?"opacity-50 cursor-not-allowed":""),"aria-label":"Add to cart",onClick:o,disabled:e||a,children:e?l.jsx(v,{}):l.jsx(x,{})}),v=()=>l.jsxs("svg",{className:"animate-spin h-5 w-5",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[l.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),l.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),x=()=>l.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z"})}),f=e.memo((({product:p,isLCPCandidate:v})=>{var x,f,b,j,_,w,y,k;const{baseMediaUrl:C}=t(),{addItemToCart:N,loading:P}=n(),{isAuthenticated:S}=r(),[M,L]=e.useState(!1),[O,z]=e.useState(!1),B=c(),$=e.useCallback((e=>u[e]||(null==e?void 0:e.replace(/_/g," "))||"Product"),[]),A=e.useCallback((e=>e||0===e?new Intl.NumberFormat("en-US",{style:"currency",currency:(null==e?void 0:e.currency)||"USD"}).format((null==e?void 0:e.value)||0):"Price not available"),[]),D=e.useCallback((e=>e.url_key?`/product/${e.url_key}`:"#"),[]),T=e.useCallback((async()=>{const e=document.createElement("div"),i=a.createRoot(e);i.render(l.jsx(s,{}));return(await o.fire({html:e,showConfirmButton:!1,showCloseButton:!0,customClass:{container:"login-popup-container",popup:"login-popup",closeButton:"login-popup-close"},width:"500px",didDestroy:()=>{i.unmount()}})).isConfirmed}),[]),I=e.useCallback((async e=>{var a,l,o,t,n,r,s,c;if(e.preventDefault(),e.stopPropagation(),M||P)return;if(!S())return void(await T());const d=[{condition:"IN_STOCK"!==p.stock_status,message:`${p.name} is out of stock.`},{condition:"DownloadableProduct"===p.__typename&&!(null==(a=p.downloadable_product_links)?void 0:a.length),message:`${p.name} has no downloadable links available.`},{condition:"BundleProduct"===p.__typename&&!(null==(l=p.items)?void 0:l.length),message:`${p.name} has no bundle options available.`},{condition:"GroupedProduct"===p.__typename&&!(null==(o=p.items)?void 0:o.length),message:`${p.name} has no grouped products available.`},{condition:"ConfigurableProduct"===p.__typename&&!(null==(t=p.configurable_options)?void 0:t.length),message:`${p.name} has no configurable options available.`}].find((e=>e.condition));if(d)return u=d.message,i.error(u),void setTimeout((()=>B(D(p))),2e3);var u;L(!0);try{const e={sku:p.sku||"",name:p.name||"Product",price:(null==(s=null==(r=null==(n=p.price_range)?void 0:n.minimum_price)?void 0:r.final_price)?void 0:s.value)||0,qty:1,product_id:p.id,extension_attributes:{image_url:(null==(c=p.small_image)?void 0:c.url)||"/placeholder.jpg"}};await N(e),i.success(`${p.name} added to cart!`)}catch(m){i.error(`Failed to add ${p.name} to cart. Try again.`)}finally{L(!1)}}),[p,M,P,N,B,D,S,T]);if(!p)return l.jsx("div",{className:"text-center p-4",children:"Product data not available"});p.id;const U=D(p),H=(null==(x=p.small_image)?void 0:x.url)||"/placeholder.jpg",W=null==(b=null==(f=p.price_range)?void 0:f.minimum_price)?void 0:b.final_price,E=null==(_=null==(j=p.price_range)?void 0:j.minimum_price)?void 0:_.regular_price,F=null==(y=null==(w=p.price_range)?void 0:w.minimum_price)?void 0:y.discount,G=(null==F?void 0:F.amount_off)>0||(null==F?void 0:F.percent_off)>0,K="IN_STOCK"!==p.stock_status;return l.jsxs("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden hover:shadow-md transition",onMouseEnter:()=>z(!0),onMouseLeave:()=>z(!1),children:[l.jsx(d,{to:U,className:"block",children:l.jsxs("div",{className:"h-48 overflow-hidden relative",children:[l.jsx("img",{src:H,alt:(null==(k=p.small_image)?void 0:k.label)||p.name||"Product",className:"w-full h-full object-contain transition-transform duration-300 ease-in-out",width:"192",height:"192",loading:v?"eager":"lazy",decoding:"async",style:{transform:O?"scale(1.05)":"scale(1)"}}),K&&l.jsx("div",{className:"absolute top-2 right-2 bg-red-500 text-white text-xs px-2 py-1 rounded",children:"Out of Stock"}),G&&l.jsx("div",{className:"absolute top-2 left-2 bg-yellow-500 text-white text-xs px-2 py-1 rounded",children:"Sale"})]})}),l.jsxs("div",{className:"p-4",children:[l.jsx(d,{to:U,children:l.jsx("h3",{className:"font-medium mb-1 hover:text-indigo-600 line-clamp-2",children:p.name||"Unnamed Product"})}),l.jsx("p",{className:"text-sm text-gray-500 mb-1 capitalize",children:$(p.__typename||p.type_id)}),p.rating_summary>0&&l.jsx(m,{rating:p.rating_summary,reviewCount:p.review_count}),l.jsxs("div",{className:"flex justify-between items-center mt-2",children:[l.jsx(g,{price:W,regularPrice:E,isOnSale:G,formatPrice:A}),l.jsx(h,{isAdding:M,isOutOfStock:K,onClick:I})]})]})]})}));export{f as P};
//# sourceMappingURL=ProductCard-CVF2HPGq.js.map
